
<!DOCTYPE html>

<html lang="en">
  <head>
    
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>キャッシュによるパフォーマンス改善 &mdash; Phalcon 1.3.1 documentation</title>
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link href='http://fonts.googleapis.com/css?family=Ubuntu:400,500,700,300italic,400italic,500italic&amp;subset=latin,cyrillic-ext' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="../_static/style.css" type="text/css" />
    <link rel="stylesheet" href="../_static/docs.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '1.3.1',
        COLLAPSE_MODINDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>

    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.1/jquery.min.js"></script>
    <script type="text/javascript" src="../_static/docs.js"></script>
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="top" title="Phalcon 1.3.1 documentation" href="../index.html" />
    <link rel="next" title="セキュリティ" href="security.html" />
    <link rel="prev" title="ページネーション" href="pagination.html" /> 
  </head>
  <body>
    <div id="wrapper">

        <div class="size-wrap">

            <div class="header clear-fix">
                <a class="header-logo" href="http://phalconphp.com"><span class="logo-text">Phalcon</span></a>
                <div class="header-right">
                    <iframe src="http://ghbtns.com/github-btn.html?user=phalcon&amp;repo=cphalcon&amp;type=watch&amp;count=true&amp;size=large"
allowtransparency="true" frameborder="0" scrolling="0" width="152px" height="30px"></iframe>
                </div>
                <ul class="header-nav">
                    <li><a href="http://phalconphp.com/" class="header-nav-link">Home</a></li>
                    <li><a href="http://phalconphp.com/download" class="header-nav-link">Download</a></li>
                    <li><a href="http://forum.phalconphp.com/" class="header-nav-link active">Forum</a></li>
                    <li><a href="http://blog.phalconphp.com/" class="header-nav-link">Blog</a></li>
                    <li><a href="http://phalconphp.com/support" class="header-nav-link">Support</a></li>
                    <li><a href="http://store.phalconphp.com/" class="header-nav-link">Store</a></li>
                    <li><a href="https://github.com/phalcon/cphalcon" class="header-nav-link">GitHub</a></li>
                </ul>
            </div>

        </div>
    <div class="header-line">
      <div class="size-wrap">
        <div class="header-line-title title-white">Documentation</div>
      </div>
    </div>
    <div class="related">
      <ul>
        <li class="right" >
          <a href="../genindex.html" title="総合索引"
             accesskey="I">索引</a></li>
        <li class="right" >
          <a href="security.html" title="セキュリティ"
             accesskey="N">次へ</a> |</li>
        <li class="right" >
          <a href="pagination.html" title="ページネーション"
             accesskey="P">前へ</a> |</li>
        <li><a href="http://phalconphp.com">Home</a> &raquo;</li>
        <li><a href="../index.html">Phalcon 1.3.1 documentation</a> &raquo;</li> 
      </ul>
    </div>  

      <table width="90%" align="center">
        <tr>
      <td class="primary-box" width="25%" valign="top">
            <div id="searchbox" style="">
                <form class="search" action="http://readthedocs.org/search/project/" method="get">
                  <input type="search" name="q" size="15" placeholder="Search">
                  <input type="submit" value="Go">
                  <input type="hidden" name="selected_facets" value="project:">
                </form>
            </div>
            <h3><a href="../index.html">目次</a></h3>
            <ul>
<li><a class="reference internal" href="#">キャッシュによるパフォーマンス改善</a><ul>
<li><a class="reference internal" href="#id2">どのような時にキャッシュを実装する？</a></li>
<li><a class="reference internal" href="#id3">キャッシュの振る舞い</a></li>
<li><a class="reference internal" href="#id4">出力する部品のキャッシュ</a></li>
<li><a class="reference internal" href="#id5">任意のデータのキャッシュ</a><ul>
<li><a class="reference internal" href="#id6">ファイルをバックエンドとする例</a></li>
<li><a class="reference internal" href="#memcached">Memcached をバックエンドとする例</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id7">キャッシュの参照</a></li>
<li><a class="reference internal" href="#deleting-data-from-the-cache">Deleting data from the cache</a></li>
<li><a class="reference internal" href="#id8">キャッシュが存在するかの確認</a></li>
<li><a class="reference internal" href="#id9">保存期間</a></li>
<li><a class="reference internal" href="#id10">マルチレベル・キャッシュ</a></li>
<li><a class="reference internal" href="#id11">フロントエンド・アダプタ</a><ul>
<li><a class="reference internal" href="#implementing-your-own-frontend-adapters">Implementing your own Frontend adapters</a></li>
</ul>
</li>
<li><a class="reference internal" href="#backend-adapters">Backend Adapters</a><ul>
<li><a class="reference internal" href="#implementing-your-own-backend-adapters">Implementing your own Backend adapters</a></li>
<li><a class="reference internal" href="#id12">ファイル・バックエンド オプション</a></li>
<li><a class="reference internal" href="#id13">Memcached バックエンド オプション</a></li>
<li><a class="reference internal" href="#apc">APC バックエンド オプション</a></li>
<li><a class="reference internal" href="#mongo">Mongo バックエンド オプション</a></li>
<li><a class="reference internal" href="#xcache">XCache バックエンド オプション</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            <h4>前のトピックへ</h4>
            <p class="topless"><a href="pagination.html" title="前の章へ">&lt; ページネーション</a></p>
            <h4>次のトピックへ</h4>
            <p class="topless"><a href="security.html" title="次の章へ">セキュリティ &gt;</a></p>
            <h3>このページ</h3>
            <ul class="this-page-menu">
              <li><a href="../_sources/reference/cache.txt" rel="nofollow">ソースコードを表示</a></li>
            </ul>
        </td>
          <td class="second-box" valign="top">
            <div class="document">
                <div class="documentwrapper">
                  <div class="bodywrapper">
                    <div class="body" >
                      
  <div class="section" id="id1">
<h1>キャッシュによるパフォーマンス改善<a class="headerlink" href="#id1" title="このヘッドラインへのパーマリンク">¶</a></h1>
<p>Phalcon provides the <a class="reference internal" href=""><em>Phalcon\Cache</em></a> class allowing faster access to frequently used or already processed data.
<a class="reference internal" href=""><em>Phalcon\Cache</em></a> is written in C, achieving higher performance and reducing the overhead when getting items from the backends.
This class uses an internal structure of frontend and backend components. Front-end components act as input sources or
interfaces, while backend components offer storage options to the class.</p>
<div class="section" id="id2">
<h2>どのような時にキャッシュを実装する？<a class="headerlink" href="#id2" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>Although this component is very fast, implementing it in cases that are not needed could lead to a loss of performance rather than gain.
We recommend you check this cases before using a cache:</p>
<ul class="simple">
<li>You are making complex calculations that every time return the same result (changing infrequently)</li>
<li>You are using a lot of helpers and the output generated is almost always the same</li>
<li>You are accessing database data constantly and these data rarely change</li>
</ul>
<blockquote class="highlights">
<div><em>NOTE</em> Even after implementing the cache, you should check the hit ratio of your cache over a period of time. This can easily
be done, especially in the case of Memcache or Apc, with the relevant tools that backends provide.</div></blockquote>
</div>
<div class="section" id="id3">
<h2>キャッシュの振る舞い<a class="headerlink" href="#id3" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>The caching process is divided into 2 parts:</p>
<ul class="simple">
<li><strong>Frontend</strong>: This part is responsible for checking if a key has expired and perform additional transformations to the data before storing and after retrieving them from the backend-</li>
<li><strong>Backend</strong>: This part is responsible for communicating, writing/reading the data required by the frontend.</li>
</ul>
</div>
<div class="section" id="id4">
<h2>出力する部品のキャッシュ<a class="headerlink" href="#id4" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>An output fragment is a piece of HTML or text that is cached as is and returned as is. The output is automatically captured
from the ob_* functions or the PHP output so that it can be saved in the cache. The following example demonstrates such usage.
It receives the output generated by PHP and stores it into a file. The contents of the file are refreshed every 172800 seconds (2 days).</p>
<p>The implementation of this caching mechanism allows us to gain performance by not executing the helper Phalcon\Tag::linkTo
call whenever this piece of code is called.</p>
<div class="highlight-php"><div class="highlight"><pre><span class="cp">&lt;?php</span>

<span class="c1">//Create an Output frontend. Cache the files for 2 days</span>
<span class="nv">$frontCache</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Phalcon\Cache\Frontend\Output</span><span class="p">(</span><span class="k">array</span><span class="p">(</span>
    <span class="s2">&quot;lifetime&quot;</span> <span class="o">=&gt;</span> <span class="mi">172800</span>
<span class="p">));</span>

<span class="c1">// Create the component that will cache from the &quot;Output&quot; to a &quot;File&quot; backend</span>
<span class="c1">// Set the cache file directory - it&#39;s important to keep the &quot;/&quot; at the end of</span>
<span class="c1">// the value for the folder</span>
<span class="nv">$cache</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Phalcon\Cache\Backend\File</span><span class="p">(</span><span class="nv">$frontCache</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span>
    <span class="s2">&quot;cacheDir&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;../app/cache/&quot;</span>
<span class="p">));</span>

<span class="c1">// Get/Set the cache file to ../app/cache/my-cache.html</span>
<span class="nv">$content</span> <span class="o">=</span> <span class="nv">$cache</span><span class="o">-&gt;</span><span class="na">start</span><span class="p">(</span><span class="s2">&quot;my-cache.html&quot;</span><span class="p">);</span>

<span class="c1">// If $content is null then the content will be generated for the cache</span>
<span class="k">if</span> <span class="p">(</span><span class="nv">$content</span> <span class="o">===</span> <span class="k">null</span><span class="p">)</span> <span class="p">{</span>

    <span class="c1">//Print date and time</span>
    <span class="k">echo</span> <span class="nb">date</span><span class="p">(</span><span class="s2">&quot;r&quot;</span><span class="p">);</span>

    <span class="c1">//Generate a link to the sign-up action</span>
    <span class="k">echo</span> <span class="nx">Phalcon\Tag</span><span class="o">::</span><span class="na">linkTo</span><span class="p">(</span>
        <span class="k">array</span><span class="p">(</span>
            <span class="s2">&quot;user/signup&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Sign Up&quot;</span><span class="p">,</span>
            <span class="s2">&quot;class&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;signup-button&quot;</span>
        <span class="p">)</span>
    <span class="p">);</span>

    <span class="c1">// Store the output into the cache file</span>
    <span class="nv">$cache</span><span class="o">-&gt;</span><span class="na">save</span><span class="p">();</span>

<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>

    <span class="c1">// Echo the cached output</span>
    <span class="k">echo</span> <span class="nv">$content</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p><em>NOTE</em> In the example above, our code remains the same, echoing output to the user as it has been doing before. Our cache component
transparently captures that output and stores it in the cache file (when the cache is generated) or it sends it back to the user
pre-compiled from a previous call, thus avoiding expensive operations.</p>
</div>
<div class="section" id="id5">
<h2>任意のデータのキャッシュ<a class="headerlink" href="#id5" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>Caching just data is equally important for your application. Caching can reduce database load by reusing commonly used (but not updated) data,
thus speeding up your application.</p>
<div class="section" id="id6">
<h3>ファイルをバックエンドとする例<a class="headerlink" href="#id6" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>One of the caching adapters is &#8216;File&#8217;. The only key area for this adapter is the location of where the cache files will be stored.
This is controlled by the cacheDir option which <em>must</em> have a backslash at the end of it.</p>
<div class="highlight-php"><div class="highlight"><pre><span class="cp">&lt;?php</span>

<span class="c1">// Cache the files for 2 days using a Data frontend</span>
<span class="nv">$frontCache</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Phalcon\Cache\Frontend\Data</span><span class="p">(</span><span class="k">array</span><span class="p">(</span>
    <span class="s2">&quot;lifetime&quot;</span> <span class="o">=&gt;</span> <span class="mi">172800</span>
<span class="p">));</span>

<span class="c1">// Create the component that will cache &quot;Data&quot; to a &quot;File&quot; backend</span>
<span class="c1">// Set the cache file directory - important to keep the &quot;/&quot; at the end of</span>
<span class="c1">// of the value for the folder</span>
<span class="nv">$cache</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Phalcon\Cache\Backend\File</span><span class="p">(</span><span class="nv">$frontCache</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span>
    <span class="s2">&quot;cacheDir&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;../app/cache/&quot;</span>
<span class="p">));</span>

<span class="c1">// Try to get cached records</span>
<span class="nv">$cacheKey</span> <span class="o">=</span> <span class="s1">&#39;robots_order_id.cache&#39;</span><span class="p">;</span>
<span class="nv">$robots</span>    <span class="o">=</span> <span class="nv">$cache</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="nv">$cacheKey</span><span class="p">);</span>
<span class="k">if</span> <span class="p">(</span><span class="nv">$robots</span> <span class="o">===</span> <span class="k">null</span><span class="p">)</span> <span class="p">{</span>

    <span class="c1">// $robots is null because of cache expiration or data does not exist</span>
    <span class="c1">// Make the database call and populate the variable</span>
    <span class="nv">$robots</span> <span class="o">=</span> <span class="nx">Robots</span><span class="o">::</span><span class="na">find</span><span class="p">(</span><span class="k">array</span><span class="p">(</span><span class="s2">&quot;order&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;id&quot;</span><span class="p">));</span>

    <span class="c1">// Store it in the cache</span>
    <span class="nv">$cache</span><span class="o">-&gt;</span><span class="na">save</span><span class="p">(</span><span class="nv">$cacheKey</span><span class="p">,</span> <span class="nv">$robots</span><span class="p">);</span>
<span class="p">}</span>

<span class="c1">// Use $robots :)</span>
<span class="k">foreach</span> <span class="p">(</span><span class="nv">$robots</span> <span class="k">as</span> <span class="nv">$robot</span><span class="p">)</span> <span class="p">{</span>
   <span class="k">echo</span> <span class="nv">$robot</span><span class="o">-&gt;</span><span class="na">name</span><span class="p">,</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="memcached">
<h3>Memcached をバックエンドとする例<a class="headerlink" href="#memcached" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>The above example changes slightly (especially in terms of configuration) when we are using a Memcached backend.</p>
<div class="highlight-php"><div class="highlight"><pre><span class="cp">&lt;?php</span>

<span class="c1">//Cache data for one hour</span>
<span class="nv">$frontCache</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Phalcon\Cache\Frontend\Data</span><span class="p">(</span><span class="k">array</span><span class="p">(</span>
    <span class="s2">&quot;lifetime&quot;</span> <span class="o">=&gt;</span> <span class="mi">3600</span>
<span class="p">));</span>

<span class="c1">// Create the component that will cache &quot;Data&quot; to a &quot;Memcached&quot; backend</span>
<span class="c1">// Memcached connection settings</span>
<span class="nv">$cache</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Phalcon\Cache\Backend\Memcache</span><span class="p">(</span><span class="nv">$frontCache</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span>
    <span class="s2">&quot;host&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;localhost&quot;</span><span class="p">,</span>
    <span class="s2">&quot;port&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;11211&quot;</span>
<span class="p">));</span>

<span class="c1">// Try to get cached records</span>
<span class="nv">$cacheKey</span> <span class="o">=</span> <span class="s1">&#39;robots_order_id.cache&#39;</span><span class="p">;</span>
<span class="nv">$robots</span>    <span class="o">=</span> <span class="nv">$cache</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="nv">$cacheKey</span><span class="p">);</span>
<span class="k">if</span> <span class="p">(</span><span class="nv">$robots</span> <span class="o">===</span> <span class="k">null</span><span class="p">)</span> <span class="p">{</span>

    <span class="c1">// $robots is null because of cache expiration or data does not exist</span>
    <span class="c1">// Make the database call and populate the variable</span>
    <span class="nv">$robots</span> <span class="o">=</span> <span class="nx">Robots</span><span class="o">::</span><span class="na">find</span><span class="p">(</span><span class="k">array</span><span class="p">(</span><span class="s2">&quot;order&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;id&quot;</span><span class="p">));</span>

    <span class="c1">// Store it in the cache</span>
    <span class="nv">$cache</span><span class="o">-&gt;</span><span class="na">save</span><span class="p">(</span><span class="nv">$cacheKey</span><span class="p">,</span> <span class="nv">$robots</span><span class="p">);</span>
<span class="p">}</span>

<span class="c1">// Use $robots :)</span>
<span class="k">foreach</span> <span class="p">(</span><span class="nv">$robots</span> <span class="k">as</span> <span class="nv">$robot</span><span class="p">)</span> <span class="p">{</span>
   <span class="k">echo</span> <span class="nv">$robot</span><span class="o">-&gt;</span><span class="na">name</span><span class="p">,</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="id7">
<h2>キャッシュの参照<a class="headerlink" href="#id7" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>The elements added to the cache are uniquely identified by a key. In the case of the File backend, the key is the
actual filename. To retrieve data from the cache, we just have to call it using the unique key. If the key does
not exist, the get method will return null.</p>
<div class="highlight-php"><div class="highlight"><pre><span class="cp">&lt;?php</span>

<span class="c1">// Retrieve products by key &quot;myProducts&quot;</span>
<span class="nv">$products</span> <span class="o">=</span> <span class="nv">$cache</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s2">&quot;myProducts&quot;</span><span class="p">);</span>
</pre></div>
</div>
<p>If you want to know which keys are stored in the cache you could call the queryKeys method:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="cp">&lt;?php</span>

<span class="c1">// Query all keys used in the cache</span>
<span class="nv">$keys</span> <span class="o">=</span> <span class="nv">$cache</span><span class="o">-&gt;</span><span class="na">queryKeys</span><span class="p">();</span>
<span class="k">foreach</span> <span class="p">(</span><span class="nv">$keys</span> <span class="k">as</span> <span class="nv">$key</span><span class="p">)</span> <span class="p">{</span>
    <span class="nv">$data</span> <span class="o">=</span> <span class="nv">$cache</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="nv">$key</span><span class="p">);</span>
    <span class="k">echo</span> <span class="s2">&quot;Key=&quot;</span><span class="p">,</span> <span class="nv">$key</span><span class="p">,</span> <span class="s2">&quot; Data=&quot;</span><span class="p">,</span> <span class="nv">$data</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">//Query keys in the cache that begins with &quot;my-prefix&quot;</span>
<span class="nv">$keys</span> <span class="o">=</span> <span class="nv">$cache</span><span class="o">-&gt;</span><span class="na">queryKeys</span><span class="p">(</span><span class="s2">&quot;my-prefix&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="section" id="deleting-data-from-the-cache">
<h2>Deleting data from the cache<a class="headerlink" href="#deleting-data-from-the-cache" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>There are times where you will need to forcibly invalidate a cache entry (due to an update in the cached data).
The only requirement is to know the key that the data have been stored with.</p>
<div class="highlight-php"><div class="highlight"><pre><span class="cp">&lt;?php</span>

<span class="c1">// Delete an item with a specific key</span>
<span class="nv">$cache</span><span class="o">-&gt;</span><span class="na">delete</span><span class="p">(</span><span class="s2">&quot;someKey&quot;</span><span class="p">);</span>

<span class="c1">// Delete all items from the cache</span>
<span class="nv">$keys</span> <span class="o">=</span> <span class="nv">$cache</span><span class="o">-&gt;</span><span class="na">queryKeys</span><span class="p">();</span>
<span class="k">foreach</span> <span class="p">(</span><span class="nv">$keys</span> <span class="k">as</span> <span class="nv">$key</span><span class="p">)</span> <span class="p">{</span>
    <span class="nv">$cache</span><span class="o">-&gt;</span><span class="na">delete</span><span class="p">(</span><span class="nv">$key</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="id8">
<h2>キャッシュが存在するかの確認<a class="headerlink" href="#id8" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>It is possible to check if a cache already exists with a given key:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="cp">&lt;?php</span>

<span class="k">if</span> <span class="p">(</span><span class="nv">$cache</span><span class="o">-&gt;</span><span class="na">exists</span><span class="p">(</span><span class="s2">&quot;someKey&quot;</span><span class="p">))</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="nv">$cache</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s2">&quot;someKey&quot;</span><span class="p">);</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s2">&quot;Cache does not exists!&quot;</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="id9">
<h2>保存期間<a class="headerlink" href="#id9" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>A &#8220;lifetime&#8221; is a time in seconds that a cache could live without expire. By default, all the created caches use the lifetime set in the frontend creation.
You can set a specific lifetime in the creation or retrieving of the data from the cache:</p>
<p>Setting the lifetime when retrieving:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="cp">&lt;?php</span>

<span class="nv">$cacheKey</span> <span class="o">=</span> <span class="s1">&#39;my.cache&#39;</span><span class="p">;</span>

<span class="c1">//Setting the cache when getting a result</span>
<span class="nv">$robots</span> <span class="o">=</span> <span class="nv">$cache</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="nv">$cacheKey</span><span class="p">,</span> <span class="mi">3600</span><span class="p">);</span>
<span class="k">if</span> <span class="p">(</span><span class="nv">$robots</span> <span class="o">===</span> <span class="k">null</span><span class="p">)</span> <span class="p">{</span>

    <span class="nv">$robots</span> <span class="o">=</span> <span class="s2">&quot;some robots&quot;</span><span class="p">;</span>

    <span class="c1">// Store it in the cache</span>
    <span class="nv">$cache</span><span class="o">-&gt;</span><span class="na">save</span><span class="p">(</span><span class="nv">$cacheKey</span><span class="p">,</span> <span class="nv">$robots</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Setting the lifetime when saving:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="cp">&lt;?php</span>

<span class="nv">$cacheKey</span> <span class="o">=</span> <span class="s1">&#39;my.cache&#39;</span><span class="p">;</span>

<span class="nv">$robots</span> <span class="o">=</span> <span class="nv">$cache</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="nv">$cacheKey</span><span class="p">);</span>
<span class="k">if</span> <span class="p">(</span><span class="nv">$robots</span> <span class="o">===</span> <span class="k">null</span><span class="p">)</span> <span class="p">{</span>

    <span class="nv">$robots</span> <span class="o">=</span> <span class="s2">&quot;some robots&quot;</span><span class="p">;</span>

    <span class="c1">//Setting the cache when saving data</span>
    <span class="nv">$cache</span><span class="o">-&gt;</span><span class="na">save</span><span class="p">(</span><span class="nv">$cacheKey</span><span class="p">,</span> <span class="nv">$robots</span><span class="p">,</span> <span class="mi">3600</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="id10">
<h2>マルチレベル・キャッシュ<a class="headerlink" href="#id10" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>This feature ​of the cache component, ​allows ​the developer to implement a multi-level cache​. This new feature is very ​useful
because you can save the same data in several cache​ locations​ with different lifetimes, reading ​first from the one with
the faster adapter and ending with the slowest one until the data expire​s​:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="cp">&lt;?php</span>

<span class="k">use</span> <span class="nx">Phalcon\Cache\Frontend\Data</span> <span class="k">as</span> <span class="nx">DataFrontend</span><span class="p">,</span>
    <span class="nx">Phalcon\Cache\Multiple</span><span class="p">,</span>
    <span class="nx">Phalcon\Cache\Backend\Apc</span> <span class="k">as</span> <span class="nx">ApcCache</span><span class="p">,</span>
    <span class="nx">Phalcon\Cache\Backend\Memcache</span> <span class="k">as</span> <span class="nx">MemcacheCache</span><span class="p">,</span>
    <span class="nx">Phalcon\Cache\Backend\File</span> <span class="k">as</span> <span class="nx">FileCache</span><span class="p">;</span>

<span class="nv">$ultraFastFrontend</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">DataFrontend</span><span class="p">(</span><span class="k">array</span><span class="p">(</span>
    <span class="s2">&quot;lifetime&quot;</span> <span class="o">=&gt;</span> <span class="mi">3600</span>
<span class="p">));</span>

<span class="nv">$fastFrontend</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">DataFrontend</span><span class="p">(</span><span class="k">array</span><span class="p">(</span>
    <span class="s2">&quot;lifetime&quot;</span> <span class="o">=&gt;</span> <span class="mi">86400</span>
<span class="p">));</span>

<span class="nv">$slowFrontend</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">DataFrontend</span><span class="p">(</span><span class="k">array</span><span class="p">(</span>
    <span class="s2">&quot;lifetime&quot;</span> <span class="o">=&gt;</span> <span class="mi">604800</span>
<span class="p">));</span>

<span class="c1">//Backends are registered from the fastest to the slower</span>
<span class="nv">$cache</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Multiple</span><span class="p">(</span><span class="k">array</span><span class="p">(</span>
    <span class="k">new</span> <span class="nx">ApcCache</span><span class="p">(</span><span class="nv">$ultraFastFrontend</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span>
        <span class="s2">&quot;prefix&quot;</span> <span class="o">=&gt;</span> <span class="s1">&#39;cache&#39;</span><span class="p">,</span>
    <span class="p">)),</span>
    <span class="k">new</span> <span class="nx">MemcacheCache</span><span class="p">(</span><span class="nv">$fastFrontend</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span>
        <span class="s2">&quot;prefix&quot;</span> <span class="o">=&gt;</span> <span class="s1">&#39;cache&#39;</span><span class="p">,</span>
        <span class="s2">&quot;host&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;localhost&quot;</span><span class="p">,</span>
        <span class="s2">&quot;port&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;11211&quot;</span>
    <span class="p">)),</span>
    <span class="k">new</span> <span class="nx">FileCache</span><span class="p">(</span><span class="nv">$slowFrontend</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span>
        <span class="s2">&quot;prefix&quot;</span> <span class="o">=&gt;</span> <span class="s1">&#39;cache&#39;</span><span class="p">,</span>
        <span class="s2">&quot;cacheDir&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;../app/cache/&quot;</span>
    <span class="p">))</span>
<span class="p">));</span>

<span class="c1">//Save, saves in every backend</span>
<span class="nv">$cache</span><span class="o">-&gt;</span><span class="na">save</span><span class="p">(</span><span class="s1">&#39;my-key&#39;</span><span class="p">,</span> <span class="nv">$data</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="section" id="id11">
<h2>フロントエンド・アダプタ<a class="headerlink" href="#id11" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>The available frontend adapters that are used as interfaces or input sources to the cache are:</p>
<table border="1" class="docutils">
<colgroup>
<col width="4%" />
<col width="64%" />
<col width="32%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Adapter</th>
<th class="head">Description</th>
<th class="head">Example</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>Output</td>
<td>Read input data from standard PHP output</td>
<td><a class="reference internal" href="../api/Phalcon_Cache_Frontend_Output.html"><em>Phalcon\Cache\Frontend\Output</em></a></td>
</tr>
<tr class="row-odd"><td>Data</td>
<td>It&#8217;s used to cache any kind of PHP data (big arrays, objects, text, etc). Data is serialized before stored in the backend.</td>
<td><a class="reference internal" href="../api/Phalcon_Cache_Frontend_Data.html"><em>Phalcon\Cache\Frontend\Data</em></a></td>
</tr>
<tr class="row-even"><td>Base64</td>
<td>It&#8217;s used to cache binary data. The data is serialized using base64_encode before be stored in the backend.</td>
<td><a class="reference internal" href="../api/Phalcon_Cache_Frontend_Base64.html"><em>Phalcon\Cache\Frontend\Base64</em></a></td>
</tr>
<tr class="row-odd"><td>Json</td>
<td>Data is encoded in JSON before be stored in the backend. Decoded after be retrieved. This frontend is useful to share data with other languages or frameworks.</td>
<td><a class="reference internal" href="../api/Phalcon_Cache_Frontend_Json.html"><em>Phalcon\Cache\Frontend\Json</em></a></td>
</tr>
<tr class="row-even"><td>IgBinary</td>
<td>It&#8217;s used to cache any kind of PHP data (big arrays, objects, text, etc). Data is serialized using IgBinary before be stored in the backend.</td>
<td><a class="reference internal" href="../api/Phalcon_Cache_Frontend_Igbinary.html"><em>Phalcon\Cache\Frontend\Igbinary</em></a></td>
</tr>
<tr class="row-odd"><td>None</td>
<td>It&#8217;s used to cache any kind of PHP data without serializing them.</td>
<td><a class="reference internal" href="../api/Phalcon_Cache_Frontend_None.html"><em>Phalcon\Cache\Frontend\None</em></a></td>
</tr>
</tbody>
</table>
<div class="section" id="implementing-your-own-frontend-adapters">
<h3>Implementing your own Frontend adapters<a class="headerlink" href="#implementing-your-own-frontend-adapters" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>The <a class="reference internal" href="../api/Phalcon_Cache_FrontendInterface.html"><em>Phalcon\Cache\FrontendInterface</em></a> interface must be implemented in order to create your own frontend adapters or extend the existing ones.</p>
</div>
</div>
<div class="section" id="backend-adapters">
<h2>Backend Adapters<a class="headerlink" href="#backend-adapters" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>The backend adapters available to store cache data are:</p>
<table border="1" class="docutils">
<colgroup>
<col width="6%" />
<col width="27%" />
<col width="7%" />
<col width="12%" />
<col width="47%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Adapter</th>
<th class="head">Description</th>
<th class="head">Info</th>
<th class="head">Required Extensions</th>
<th class="head">Example</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>File</td>
<td>Stores data to local plain files</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td><a class="reference internal" href="../api/Phalcon_Cache_Backend_File.html"><em>Phalcon\Cache\Backend\File</em></a></td>
</tr>
<tr class="row-odd"><td>Memcached</td>
<td>Stores data to a memcached server</td>
<td><a class="reference external" href="http://www.php.net/memcache">Memcached</a></td>
<td><a class="reference external" href="http://pecl.php.net/package/memcache">memcache</a></td>
<td><a class="reference internal" href="../api/Phalcon_Cache_Backend_Memcache.html"><em>Phalcon\Cache\Backend\Memcache</em></a></td>
</tr>
<tr class="row-even"><td>APC</td>
<td>Stores data to the Alternative PHP Cache (APC)</td>
<td><a class="reference external" href="http://php.net/apc">APC</a></td>
<td><a class="reference external" href="http://pecl.php.net/package/APC">APC extension</a></td>
<td><a class="reference internal" href="../api/Phalcon_Cache_Backend_Apc.html"><em>Phalcon\Cache\Backend\Apc</em></a></td>
</tr>
<tr class="row-odd"><td>Mongo</td>
<td>Stores data to Mongo Database</td>
<td><a class="reference external" href="http://mongodb.org/">MongoDb</a></td>
<td><a class="reference external" href="http://pecl.php.net/package/mongo">Mongo</a></td>
<td><a class="reference internal" href="../api/Phalcon_Cache_Backend_Mongo.html"><em>Phalcon\Cache\Backend\Mongo</em></a></td>
</tr>
<tr class="row-even"><td>XCache</td>
<td>Stores data in XCache</td>
<td><a class="reference external" href="http://xcache.lighttpd.net/">XCache</a></td>
<td><a class="reference external" href="http://pecl.php.net/package/xcache">xcache extension</a></td>
<td><a class="reference internal" href="../api/Phalcon_Cache_Backend_Xcache.html"><em>Phalcon\Cache\Backend\Xcache</em></a></td>
</tr>
</tbody>
</table>
<div class="section" id="implementing-your-own-backend-adapters">
<h3>Implementing your own Backend adapters<a class="headerlink" href="#implementing-your-own-backend-adapters" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>The <a class="reference internal" href="../api/Phalcon_Cache_BackendInterface.html"><em>Phalcon\Cache\BackendInterface</em></a> interface must be implemented in order to create your own backend adapters or extend the existing ones.</p>
</div>
<div class="section" id="id12">
<h3>ファイル・バックエンド オプション<a class="headerlink" href="#id12" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>This backend will store cached content into files in the local server. The available options for this backend are:</p>
<table border="1" class="docutils">
<colgroup>
<col width="14%" />
<col width="86%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Option</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>prefix</td>
<td>A prefix that is automatically prepended to the cache keys</td>
</tr>
<tr class="row-odd"><td>cacheDir</td>
<td>A writable directory on which cached files will be placed</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id13">
<h3>Memcached バックエンド オプション<a class="headerlink" href="#id13" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>This backend will store cached content on a memcached server. The available options for this backend are:</p>
<table border="1" class="docutils">
<colgroup>
<col width="16%" />
<col width="84%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Option</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>prefix</td>
<td>A prefix that is automatically prepended to the cache keys</td>
</tr>
<tr class="row-odd"><td>host</td>
<td>memcached host</td>
</tr>
<tr class="row-even"><td>port</td>
<td>memcached port</td>
</tr>
<tr class="row-odd"><td>persistent</td>
<td>create a persitent connection to memcached?</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="apc">
<h3>APC バックエンド オプション<a class="headerlink" href="#apc" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>This backend will store cached content on Alternative PHP Cache (<a class="reference external" href="http://php.net/apc">APC</a>). The available options for this backend are:</p>
<table border="1" class="docutils">
<colgroup>
<col width="16%" />
<col width="84%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Option</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>prefix</td>
<td>A prefix that is automatically prepended to the cache keys</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="mongo">
<h3>Mongo バックエンド オプション<a class="headerlink" href="#mongo" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>This backend will store cached content on a MongoDB server. The available options for this backend are:</p>
<table border="1" class="docutils">
<colgroup>
<col width="16%" />
<col width="84%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Option</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>prefix</td>
<td>A prefix that is automatically prepended to the cache keys</td>
</tr>
<tr class="row-odd"><td>server</td>
<td>A MongoDB connection string</td>
</tr>
<tr class="row-even"><td>db</td>
<td>Mongo database name</td>
</tr>
<tr class="row-odd"><td>collection</td>
<td>Mongo collection in the database</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="xcache">
<h3>XCache バックエンド オプション<a class="headerlink" href="#xcache" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>This backend will store cached content on XCache (<a class="reference external" href="http://xcache.lighttpd.net/">XCache</a>). The available options for this backend are:</p>
<table border="1" class="docutils">
<colgroup>
<col width="16%" />
<col width="84%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Option</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>prefix</td>
<td>A prefix that is automatically prepended to the cache keys</td>
</tr>
</tbody>
</table>
<p>There are more adapters available for this components in the <a class="reference external" href="https://github.com/phalcon/incubator">Phalcon Incubator</a></p>
</div>
</div>
</div>


                    </div>
                  </div>
                </div>
            </div>
          </td>
        </tr>
      </table>
    <div class="related">
      <ul>
        <li class="right" >
          <a href="../genindex.html" title="総合索引"
             >索引</a></li>
        <li class="right" >
          <a href="security.html" title="セキュリティ"
             >次へ</a> |</li>
        <li class="right" >
          <a href="pagination.html" title="ページネーション"
             >前へ</a> |</li> 
      </ul>
    </div>
        <div id="footer">

          <p>Found a typo or an error? Want to improve this document? The documentation sources are available on <a href="http://github.com/phalcon/docs">Github</a></p>
          <p>Need support or have questions? Check our <a href="http://phalconphp.com/support">Support Page</a></p>

          <p>The Phalcon PHP Framework is released under the <a href="https://github.com/phalcon/cphalcon/blob/master/docs/LICENSE.md">new BSD license</a>.</p>
          <p>Except where otherwise noted, content on this site is licensed under the
            <a href="http://creativecommons.org/licenses/by/3.0/">Creative Commons Attribution 3.0 License.</a></p>
             最終更新: Oct 21, 2014
            このドキュメントは <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3 で生成しました。

          <p>
             &copy; Copyright 2014, Phalcon Team and contributors.
          </p>

            <div class="size-wrap footer-wrap">

                <div class="donate-wrap">
                    Donate to Phalcon: <a href="http://flattr.com/thing/1134206/Phalcon-PHP-Framework" target="_blank" class="button button-small orange">Flattr</a>
                    or
                    <form action="https://www.paypal.com/cgi-bin/webscr" method="post" style="display: inline">
                        <input type="hidden" name="cmd" value="_s-xclick">
                        <input type="hidden" name="hosted_button_id" value="7LSYMNMFZNG8W">
                        <input class="button button-small orange" style="border: inherit; display: inline; font-weight: bold" type="submit" value="via Paypal" title="PayPal — The safer, easier way to pay online.">
                    </form>
                </div>

                <div class="social-links">
                    <a href="https://twitter.com/phalconphp" class="social-link tw">Twitter</a>
                    <a href="http://www.facebook.com/pages/Phalcon/134230726685897" class="social-link fb">Facebook</a>
                    <a href="https://plus.google.com/102376109340560896457" class="social-link gp">Google Plus</a>
                    <a href="http://vimeo.com/user10964377" class="social-link vm">Vimeo</a>
                </div>

            </div>

        </div>

    </div>
  </body>
</html>