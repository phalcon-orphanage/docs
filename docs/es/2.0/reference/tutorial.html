
<!DOCTYPE html>

<html lang="en">
  <head>
    
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Tutorial 1: Aprendamos usando ejemplos &mdash; Phalcon 1.3.0 documentation</title>
    <link href='http://fonts.googleapis.com/css?family=Ubuntu:400,500,700,300italic,400italic,500italic&amp;subset=latin,cyrillic-ext' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/style.css" type="text/css" />
    <link rel="stylesheet" href="../_static/docs.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '1.3.0',
        COLLAPSE_MODINDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>

    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.1/jquery.min.js"></script>
    <script type="text/javascript" src="../_static/docs.js"></script>
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="top" title="Phalcon 1.3.0 documentation" href="../index.html" />
    <link rel="next" title="Tutorial 2: Explicando INVO" href="tutorial-invo.html" />
    <link rel="prev" title="Notas para la instalación en Cherokee" href="cherokee.html" /> 
  </head>
  <body>
    <div id="wrapper">

        <div class="size-wrap">

            <div class="header clear-fix">
                <a class="header-logo" href="http://phalconphp.com"><span class="logo-text">Phalcon</span></a>
                <div class="header-right">
                    <iframe src="http://ghbtns.com/github-btn.html?user=phalcon&amp;repo=cphalcon&amp;type=watch&amp;count=true&amp;size=large"
allowtransparency="true" frameborder="0" scrolling="0" width="152px" height="30px"></iframe>
                </div>
                <ul class="header-nav">
                    <li><a href="http://phalconphp.com/" class="header-nav-link">Home</a></li>
                    <li><a href="http://phalconphp.com/download" class="header-nav-link">Download</a></li>
                    <li><a href="http://forum.phalconphp.com/" class="header-nav-link active">Forum</a></li>
                    <li><a href="http://blog.phalconphp.com/" class="header-nav-link">Blog</a></li>
                    <li><a href="http://phalconphp.com/support" class="header-nav-link">Support</a></li>
                    <li><a href="http://store.phalconphp.com/" class="header-nav-link">Store</a></li>
                    <li><a href="https://github.com/phalcon/cphalcon" class="header-nav-link">GitHub</a></li>
                </ul>
            </div>

        </div>
    <div class="header-line">
      <div class="size-wrap">
        <div class="header-line-title title-white">Documentation</div>
      </div>
    </div>
    <div class="related">
      <ul>
        <li class="right" >
          <a href="../genindex.html" title="Índice General"
             accesskey="I">índice</a></li>
        <li class="right" >
          <a href="tutorial-invo.html" title="Tutorial 2: Explicando INVO"
             accesskey="N">siguiente</a> |</li>
        <li class="right" >
          <a href="cherokee.html" title="Notas para la instalación en Cherokee"
             accesskey="P">anterior</a> |</li>
        <li><a href="http://phalconphp.com">Home</a> &raquo;</li>
        <li><a href="../index.html">Phalcon 1.3.0 documentation</a> &raquo;</li> 
      </ul>
    </div>  

      <table width="90%" align="center">
        <tr>
      <td class="primary-box" width="25%" valign="top">
            <div>
            <div id="searchbox" style="">
                <!--<form class="search" action="http://readthedocs.org/search/project/" method="get">
                  <input type="search" name="q" size="25" placeholder="Search">
                  <input type="submit" value="Go">
                  <input type="hidden" name="selected_facets" value="project:">
                </form>-->
                <div style="width:200px;padding:10px">
                  <gcse:searchbox-only></gcse:searchbox-only>
                </div>
                <hr>
            </div>
            </div>
            <div style="padding:5px;padding-left:10px">
              <div id="carbonads-container">
                <div class="carbonad"><div id="azcarbon"></div>
                <script type="text/javascript">var z = document.createElement("script"); z.type = "text/javascript"; z.async = true; z.src = "http://engine.carbonads.com/z/56496/azcarbon_2_1_0_VERT"; var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(z, s);</script>
                </div></div>
            </div>
            <h3><a href="../index.html">Contenidos</a></h3>
            <ul>
<li><a class="reference internal" href="#">Tutorial 1: Aprendamos usando ejemplos</a><ul>
<li><a class="reference internal" href="#revisando-tu-instalacion">Revisando tu instalación</a></li>
<li><a class="reference internal" href="#creando-un-proyecto">Creando un proyecto</a><ul>
<li><a class="reference internal" href="#estructura-de-directorios">Estructura de Directorios</a></li>
<li><a class="reference internal" href="#urls-amigables">URLs Amigables</a></li>
<li><a class="reference internal" href="#bootstrap">Bootstrap</a></li>
<li><a class="reference internal" href="#autocargadores">Autocargadores</a></li>
<li><a class="reference internal" href="#administracion-de-dependencias">Administración de Dependencias</a></li>
<li><a class="reference internal" href="#creando-un-controlador">Creando un Controlador</a></li>
<li><a class="reference internal" href="#generando-salida-a-la-vista">Generando salida a la vista</a></li>
<li><a class="reference internal" href="#disenando-una-formulario-de-registro">Diseñando una formulario de registro</a></li>
<li><a class="reference internal" href="#creando-un-modelo">Creando un Modelo</a></li>
<li><a class="reference internal" href="#estableciendo-la-conexion-a-la-base-de-datos">Estableciendo la conexión a la base de datos</a></li>
<li><a class="reference internal" href="#guardando-datos-mediante-modelos">Guardando datos mediante modelos</a></li>
</ul>
</li>
<li><a class="reference internal" href="#conclusion">Conclusión</a></li>
<li><a class="reference internal" href="#aplicaciones-de-ejemplo">Aplicaciones de Ejemplo</a></li>
</ul>
</li>
</ul>

            <h4>Tema anterior</h4>
            <p class="topless"><a href="cherokee.html" title="Capítulo anterior">&lt; Notas para la instalación en Cherokee</a></p>
            <h4>Próximo tema</h4>
            <p class="topless"><a href="tutorial-invo.html" title="Próximo capítulo">Tutorial 2: Explicando INVO &gt;</a></p>
            <h3>Esta página</h3>
            <ul class="this-page-menu">
              <li><a href="../_sources/reference/tutorial.txt" rel="nofollow">Enseñar el código</a></li>
            </ul>
        </td>
          <td class="second-box" valign="top">
            <div class="document">
                <div class="documentwrapper">
                  <div class="bodywrapper">
                    <div class="body" >
                      
  <div class="section" id="tutorial-1-aprendamos-usando-ejemplos">
<h1>Tutorial 1: Aprendamos usando ejemplos<a class="headerlink" href="#tutorial-1-aprendamos-usando-ejemplos" title="Enlazar permanentemente con este título">¶</a></h1>
<p>A lo largo de este tutorial, te guiaremos en la creación desde cero de una aplicación que contiene un simple formulario de registro.
Además explicaremos algunos aspectos básicos del framework. Si estas interesado en la generación automática de código
para Phalcon, puedes ver nuestro <a class="reference internal" href="tools.html"><em>developer tools</em></a>.</p>
<div class="section" id="revisando-tu-instalacion">
<h2>Revisando tu instalación<a class="headerlink" href="#revisando-tu-instalacion" title="Enlazar permanentemente con este título">¶</a></h2>
<p>Asumiremos que ya has instalado Phalcon. Revisa que la salida de tu phpinfo() incluya una sección mencionando &#8220;Phalcon&#8221; o
ejecuta el siguiente código a continuación:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="cp">&lt;?php</span> <span class="nb">print_r</span><span class="p">(</span><span class="nb">get_loaded_extensions</span><span class="p">());</span> <span class="cp">?&gt;</span><span class="x"></span>
</pre></div>
</div>
<p>La extensión de Phalcon debe aparecer como parte de la salida:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="x">Array</span>
<span class="x">(</span>
<span class="x">    [0] =&gt; Core</span>
<span class="x">    [1] =&gt; libxml</span>
<span class="x">    [2] =&gt; filter</span>
<span class="x">    [3] =&gt; SPL</span>
<span class="x">    [4] =&gt; standard</span>
<span class="x">    [5] =&gt; phalcon</span>
<span class="x">    [6] =&gt; pdo_mysql</span>
<span class="x">)</span>
</pre></div>
</div>
</div>
<div class="section" id="creando-un-proyecto">
<h2>Creando un proyecto<a class="headerlink" href="#creando-un-proyecto" title="Enlazar permanentemente con este título">¶</a></h2>
<p>La mejor forma de usar esta guia es siguiendo cada paso. Si lo deseas puedes encontrar el código completo <a class="reference external" href="https://github.com/phalcon/tutorial">aquí</a>.</p>
<div class="section" id="estructura-de-directorios">
<h3>Estructura de Directorios<a class="headerlink" href="#estructura-de-directorios" title="Enlazar permanentemente con este título">¶</a></h3>
<p>Phalcon no te impone que uses una determinada estructura de directorios para desarrollar. Gracias al hecho que es libremente acoplado, puedes crear aplicaciones con Phalcon con cualquier estructura con
la que te sientas cómodo.</p>
<p>Para efectos de este tutorial y como punto de inicio, te sugerimos la siguiente estructura:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="x">tutorial/</span>
<span class="x">  app/</span>
<span class="x">    controllers/</span>
<span class="x">    models/</span>
<span class="x">    views/</span>
<span class="x">  public/</span>
<span class="x">    css/</span>
<span class="x">    img/</span>
<span class="x">    js/</span>
</pre></div>
</div>
<p>Ten en cuenta que no necesitas un directorio &#8220;library&#8221; para Phalcon. El framework está en memoria y listo para ser usado en cualquier parte.</p>
</div>
<div class="section" id="urls-amigables">
<h3>URLs Amigables<a class="headerlink" href="#urls-amigables" title="Enlazar permanentemente con este título">¶</a></h3>
<p>Usaremos URLS bonitas o amigables para este tutorial. Estas Urls son mejores para SEO, además los usuarios las recuerdan más fácilmente.
Phalcon soporta modulos de reescritura (rewrite) proporcionados por los servidores web más populares. Que tus aplicaciones tengan URLs
amigables no es una obligación y también podrás desarrollar tu aplicación sin ellas.</p>
<p>En este ejemplo usaremos el modulo rewrite para Apache. Vamos a crear una serie de reglas en el archivo /.htaccess:</p>
<div class="highlight-apacheconf"><div class="highlight"><pre><span class="c">#/.htaccess</span>
<span class="nt">&lt;IfModule</span> <span class="s">mod_rewrite.c</span><span class="nt">&gt;</span>
    <span class="nb">RewriteEngine</span> <span class="k">on</span>
    <span class="nb">RewriteRule</span>  ^$ public/    [L]
    <span class="nb">RewriteRule</span>  (.*) public/$1 [L]
<span class="nt">&lt;/IfModule&gt;</span>
</pre></div>
</div>
<p>Todas las peticiones al proyecto serán dirigidas al directorio public/ ejerciendo este como directorio raíz.
Este paso asegura que los archivos internos del proyecto permanezcan ocultos del público evitando posibles problemas de seguridad.</p>
<p>El segundo conjunto de reglas permitirá servir los archivos existentes y redireccionar lo demás al bootstrap de la aplicación:</p>
<div class="highlight-apacheconf"><div class="highlight"><pre><span class="c">#/public/.htaccess</span>
<span class="nt">&lt;IfModule</span> <span class="s">mod_rewrite.c</span><span class="nt">&gt;</span>
    <span class="nb">RewriteEngine</span> <span class="k">On</span>
    <span class="nb">RewriteCond</span> %{REQUEST_FILENAME} !-d
    <span class="nb">RewriteCond</span> %{REQUEST_FILENAME} !-f
    <span class="nb">RewriteRule</span> ^(.*)$ index.php?_url=/$1 [QSA,L]
<span class="nt">&lt;/IfModule&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="bootstrap">
<h3>Bootstrap<a class="headerlink" href="#bootstrap" title="Enlazar permanentemente con este título">¶</a></h3>
<p>El primer archivo que debes crear es el bootstrap. Este archivo es muy importante, ya que sirve como base de tu aplicación, dándote
control sobre muchos aspectos en ella. En este archivo podemos implementar la inicialización de componentes así como cambiar
el comportamiento de la aplicación.</p>
<p>El archivo public/index.php debería verse así:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="cp">&lt;?php</span>

<span class="k">try</span> <span class="p">{</span>

    <span class="c1">//Registrar un autocargador</span>
    <span class="nv">$loader</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">\Phalcon\Loader</span><span class="p">();</span>
    <span class="nv">$loader</span><span class="o">-&gt;</span><span class="na">registerDirs</span><span class="p">(</span><span class="k">array</span><span class="p">(</span>
        <span class="s1">&#39;../app/controllers/&#39;</span><span class="p">,</span>
        <span class="s1">&#39;../app/models/&#39;</span>
    <span class="p">))</span><span class="o">-&gt;</span><span class="na">register</span><span class="p">();</span>

    <span class="c1">//Crear un Inyector de dependencias</span>
    <span class="nv">$di</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">\Phalcon\DI\FactoryDefault</span><span class="p">();</span>

    <span class="c1">//Configurar el componente de vistas</span>
    <span class="nv">$di</span><span class="o">-&gt;</span><span class="na">set</span><span class="p">(</span><span class="s1">&#39;view&#39;</span><span class="p">,</span> <span class="k">function</span><span class="p">(){</span>
        <span class="nv">$view</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">\Phalcon\Mvc\View</span><span class="p">();</span>
        <span class="nv">$view</span><span class="o">-&gt;</span><span class="na">setViewsDir</span><span class="p">(</span><span class="s1">&#39;../app/views/&#39;</span><span class="p">);</span>
        <span class="k">return</span> <span class="nv">$view</span><span class="p">;</span>
    <span class="p">});</span>

    <span class="c1">//Atender la petición</span>
    <span class="nv">$application</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">\Phalcon\Mvc\Application</span><span class="p">(</span><span class="nv">$di</span><span class="p">);</span>

    <span class="k">echo</span> <span class="nv">$application</span><span class="o">-&gt;</span><span class="na">handle</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">getContent</span><span class="p">();</span>

<span class="p">}</span> <span class="k">catch</span><span class="p">(</span><span class="nx">\Phalcon\Exception</span> <span class="nv">$e</span><span class="p">)</span> <span class="p">{</span>
     <span class="k">echo</span> <span class="s2">&quot;PhalconException: &quot;</span><span class="p">,</span> <span class="nv">$e</span><span class="o">-&gt;</span><span class="na">getMessage</span><span class="p">();</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="autocargadores">
<h3>Autocargadores<a class="headerlink" href="#autocargadores" title="Enlazar permanentemente con este título">¶</a></h3>
<p>La primera parte que encontramos en el bootstrap es el registro de un autocargador. Este será usado para cargar clases como controladores y modelos en la aplicación.
Por ejemplo podemos registrar uno o más directorios de controladores incrementando la flexibilidad de la aplicación.</p>
<p>En nuestro ejemplo hemos usado el componente Phalcon\Loader. Con él, podemos cargar clases usando varias estrategias, para
este ejemplo vamos a cargar las clases basado en unos directorios predeterminados.</p>
<div class="highlight-php"><div class="highlight"><pre><span class="cp">&lt;?php</span>

<span class="nv">$loader</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">\Phalcon\Loader</span><span class="p">();</span>
<span class="nv">$loader</span><span class="o">-&gt;</span><span class="na">registerDirs</span><span class="p">(</span>
    <span class="k">array</span><span class="p">(</span>
        <span class="s1">&#39;../app/controllers/&#39;</span><span class="p">,</span>
        <span class="s1">&#39;../app/models/&#39;</span>
    <span class="p">)</span>
<span class="p">)</span><span class="o">-&gt;</span><span class="na">register</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="section" id="administracion-de-dependencias">
<h3>Administración de Dependencias<a class="headerlink" href="#administracion-de-dependencias" title="Enlazar permanentemente con este título">¶</a></h3>
<p>Un concepto muy importante que debemos entender al trabajar con Phalcon es su <a class="reference internal" href="di.html"><em>contenedor/inyector de dependencias</em></a>.
Puede sonar complejo pero en realidad es muy sencillo y práctico.</p>
<p>Un contenedor de servicios es una bolsa donde globalmente registramos los servicios que nuestra aplicación necesita para trabajar.
Cada vez que requerimos un componente, le solicitaremos al contenedor el servicio usando un nombre previamente convenido.
Ya que Phalcon es un framework libremente acoplado, Phalcon\DI actúa como intermediario facilitando la integración
de los diferentes componentes logrando que trabajen juntos de manera transparente.</p>
<div class="highlight-php"><div class="highlight"><pre><span class="cp">&lt;?php</span>

<span class="c1">//Crear un DI</span>
<span class="nv">$di</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Phalcon\DI\FactoryDefault</span><span class="p">();</span>
</pre></div>
</div>
<p><a class="reference internal" href="../api/Phalcon_DI_FactoryDefault.html"><em>Phalcon\DI\FactoryDefault</em></a> es una variante de Phalcon\DI.
Para hacer las cosas más fáciles, él ya tiene registrado la mayoría de componentes que vienen con Phalcon.
De esta manera no debemos registrarlos uno a uno. Puedes reemplazar un componente por otro en cualquier momento que lo desees.</p>
<p>Luego, registramos el servicio &#8216;view&#8217;, en él indicamos el directorio que el framework debe utilizar para cargar los archivos de vistas.
Como las vistas no son clases como tal, ellas no pueden ser cargadas usando un autocargadores.</p>
<p>Los servicios pueden ser registrados de muchas maneras, para nuestro tutorial usaremos funciones anónimas:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="cp">&lt;?php</span>

<span class="c1">//Configurar el componente de vistas</span>
<span class="nv">$di</span><span class="o">-&gt;</span><span class="na">set</span><span class="p">(</span><span class="s1">&#39;view&#39;</span><span class="p">,</span> <span class="k">function</span><span class="p">(){</span>
    <span class="nv">$view</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">\Phalcon\Mvc\View</span><span class="p">();</span>
    <span class="nv">$view</span><span class="o">-&gt;</span><span class="na">setViewsDir</span><span class="p">(</span><span class="s1">&#39;../app/views/&#39;</span><span class="p">);</span>
    <span class="k">return</span> <span class="nv">$view</span><span class="p">;</span>
<span class="p">});</span>
</pre></div>
</div>
<p>En la última parte, encontramos a <a class="reference internal" href="../api/Phalcon_Mvc_Application.html"><em>Phalcon\Mvc\Application</em></a>.
Su proposito es inicializar el entorno de la petición, enrutar, descubrir las acciones relacionadas, produciendo las
respuestas para el cliente.</p>
<div class="highlight-php"><div class="highlight"><pre><span class="cp">&lt;?php</span>

<span class="nv">$application</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">\Phalcon\Mvc\Application</span><span class="p">(</span><span class="nv">$di</span><span class="p">);</span>

<span class="k">echo</span> <span class="nv">$application</span><span class="o">-&gt;</span><span class="na">handle</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">getContent</span><span class="p">();</span>
</pre></div>
</div>
<p>En resúmen, como puedes ver el bootstap es muy pequeño y no requiere archivos externos. Hemos configurado un MVC muy flexible
en menos de 30 líneas de código.</p>
</div>
<div class="section" id="creando-un-controlador">
<h3>Creando un Controlador<a class="headerlink" href="#creando-un-controlador" title="Enlazar permanentemente con este título">¶</a></h3>
<p>Por defecto Phalcon buscará un controlador llamado &#8220;Index&#8221;. Este es el punto de inicio cuando no se ha indicado una ruta o acción especifica en la petición.
El controlador Index (app/controllers/IndexController.php) se ve así:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="cp">&lt;?php</span>

<span class="k">class</span> <span class="nc">IndexController</span> <span class="k">extends</span> <span class="nx">\Phalcon\Mvc\Controller</span>
<span class="p">{</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">indexAction</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="k">echo</span> <span class="s2">&quot;&lt;h1&gt;Hola!&lt;/h1&gt;&quot;</span><span class="p">;</span>
    <span class="p">}</span>

<span class="p">}</span>
</pre></div>
</div>
<p>Las clases de controlador deben tener el sufijo &#8220;Controller&#8221; y las acciones el sufijo &#8220;Action&#8221;. Si accedes a tu aplicación desde el navegador,
podrás ver algo como esto:</p>
<div class="figure align-center">
<img alt="../_images/tutorial-1.png" src="../_images/tutorial-1.png" />
</div>
<p>Felicidades, estás volando con Phalcon!</p>
</div>
<div class="section" id="generando-salida-a-la-vista">
<h3>Generando salida a la vista<a class="headerlink" href="#generando-salida-a-la-vista" title="Enlazar permanentemente con este título">¶</a></h3>
<p>Generar salidas desde los controladores es a veces necesario pero no deseable para la mayoria de puristas del MVC.
Toda información debe ser pasada a la vista la cual es responsable de imprimirla y presentarla al cliente.
Phalcon buscará una vista con el mismo nombre de la última acción ejecutada dentro de un directorio
con el nombre del último controlador ejecutado. En nuestro caso (app/views/index/index.phtml):</p>
<div class="highlight-php"><div class="highlight"><pre><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="s2">&quot;&lt;h1&gt;Hello!&lt;/h1&gt;&quot;</span><span class="p">;</span>
</pre></div>
</div>
<p>Ahora nuestro controlador (app/controllers/IndexController.php) tiene la implementación de una acción vacia:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="cp">&lt;?php</span>

<span class="k">class</span> <span class="nc">IndexController</span> <span class="k">extends</span> <span class="nx">\Phalcon\Mvc\Controller</span>
<span class="p">{</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">indexAction</span><span class="p">()</span>
    <span class="p">{</span>

    <span class="p">}</span>

<span class="p">}</span>
</pre></div>
</div>
<p>La salida en el navagador permanece igual. El <a class="reference internal" href="../api/Phalcon_Mvc_View.html"><em>Phalcon\Mvc\View</em></a> es automáticamente creado y terminado cuando la petición termina.
Puedes ver más sobre el <a class="reference internal" href="views.html"><em>uso de vistas aquí</em></a> .</p>
</div>
<div class="section" id="disenando-una-formulario-de-registro">
<h3>Diseñando una formulario de registro<a class="headerlink" href="#disenando-una-formulario-de-registro" title="Enlazar permanentemente con este título">¶</a></h3>
<p>Ahora cambiaremos el archivo index.phtml para agregar un enlace a un nuevo controllador llamado &#8220;signup&#8221;.
El objetivo de esto es permitir a los usuarios registrarse en nuestra aplicación.</p>
<div class="highlight-php"><div class="highlight"><pre><span class="cp">&lt;?php</span>

<span class="k">echo</span> <span class="s2">&quot;&lt;h1&gt;Hello!&lt;/h1&gt;&quot;</span><span class="p">;</span>

<span class="k">echo</span> <span class="nx">Phalcon\Tag</span><span class="o">::</span><span class="na">linkTo</span><span class="p">(</span><span class="s2">&quot;signup&quot;</span><span class="p">,</span> <span class="s2">&quot;Sign Up Here!&quot;</span><span class="p">);</span>
</pre></div>
</div>
<p>El HTML generado muestra una eqiqueta &#8220;A&#8221; enlazando al nuevo controlador:</p>
<div class="highlight-html"><div class="highlight"><pre><span class="nt">&lt;h1&gt;</span>Hello!<span class="nt">&lt;/h1&gt;</span> <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">&quot;/test/signup&quot;</span><span class="nt">&gt;</span>Sign Up Here!<span class="nt">&lt;/a&gt;</span>
</pre></div>
</div>
<p>Para generar la etiqueta hemos usado la clase <a class="reference internal" href="../api/Phalcon_Tag.html"><em>Phalcon\Tag</em></a>.
Esta es una clase utilitaria que nos permite construir código HTML teniendo en cuenta las convenciones del framework.
Puedes encontrar más información relacionada a la generación de etiquetas HTML aquí <a class="reference internal" href="tags.html"><em>found here</em></a></p>
<div class="figure align-center">
<img alt="../_images/tutorial-2.png" src="../_images/tutorial-2.png" />
</div>
<p>Aquí está el controlador Signup (app/controllers/SignupController.php):</p>
<div class="highlight-php"><div class="highlight"><pre><span class="cp">&lt;?php</span>

<span class="k">class</span> <span class="nc">SignupController</span> <span class="k">extends</span> <span class="nx">\Phalcon\Mvc\Controller</span>
<span class="p">{</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">indexAction</span><span class="p">()</span>
    <span class="p">{</span>

    <span class="p">}</span>

<span class="p">}</span>
</pre></div>
</div>
<p>Al encontrarce la acción &#8216;index&#8217; vacía se da paso a la vista, la cual contiene el formulario:</p>
<div class="highlight-html+php"><div class="highlight"><pre><span class="cp">&lt;?php</span> <span class="k">use</span> <span class="nx">Phalcon\Tag</span><span class="p">;</span> <span class="cp">?&gt;</span>

<span class="nt">&lt;h2&gt;</span>Registrate haciendo uso de este formulario<span class="nt">&lt;/h2&gt;</span>

<span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nx">Tag</span><span class="o">::</span><span class="na">form</span><span class="p">(</span><span class="s2">&quot;signup/register&quot;</span><span class="p">);</span> <span class="cp">?&gt;</span>

 <span class="nt">&lt;p&gt;</span>
    <span class="nt">&lt;label</span> <span class="na">for=</span><span class="s">&quot;name&quot;</span><span class="nt">&gt;</span>Nombre<span class="nt">&lt;/label&gt;</span>
    <span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nx">Tag</span><span class="o">::</span><span class="na">textField</span><span class="p">(</span><span class="s2">&quot;name&quot;</span><span class="p">)</span> <span class="cp">?&gt;</span>
 <span class="nt">&lt;/p&gt;</span>

 <span class="nt">&lt;p&gt;</span>
    <span class="nt">&lt;label</span> <span class="na">for=</span><span class="s">&quot;name&quot;</span><span class="nt">&gt;</span>Correo electrónico<span class="nt">&lt;/label&gt;</span>
    <span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nx">Tag</span><span class="o">::</span><span class="na">textField</span><span class="p">(</span><span class="s2">&quot;email&quot;</span><span class="p">)</span> <span class="cp">?&gt;</span>
 <span class="nt">&lt;/p&gt;</span>

 <span class="nt">&lt;p&gt;</span>
    <span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nx">Tag</span><span class="o">::</span><span class="na">submitButton</span><span class="p">(</span><span class="s2">&quot;Registrarme&quot;</span><span class="p">)</span> <span class="cp">?&gt;</span>
 <span class="nt">&lt;/p&gt;</span>

<span class="nt">&lt;/form&gt;</span>
</pre></div>
</div>
<p>Visualizando el formulario en tu navegador mostrará algo como esto:</p>
<div class="figure align-center">
<img alt="../_images/tutorial-3.png" src="../_images/tutorial-3.png" />
</div>
<p><a class="reference internal" href="../api/Phalcon_Tag.html"><em>Phalcon\Tag</em></a> también proporciona métodos para definir formularios.</p>
<p>El método Phalcon\Tag::form recibe un parámetro, una URI relativa a el controlador/acción en la aplicación.</p>
<p>Al hacer click en el botón &#8220;Registrarme&#8221;, verás que el framework lanza una excepción indicando que
nos hace falta definir la acción &#8220;register&#8221; en el controlador &#8220;signup&#8221;:</p>
<blockquote>
<div>PhalconException: Action &#8220;register&#8221; was not found on controller &#8220;signup&#8221;</div></blockquote>
<p>Continuemos con la implementación de esta acción para no mostrar más la excepción:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="cp">&lt;?php</span>

<span class="k">class</span> <span class="nc">SignupController</span> <span class="k">extends</span> <span class="nx">\Phalcon\Mvc\Controller</span>
<span class="p">{</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">indexAction</span><span class="p">()</span>
    <span class="p">{</span>

    <span class="p">}</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">registerAction</span><span class="p">()</span>
    <span class="p">{</span>

    <span class="p">}</span>

<span class="p">}</span>
</pre></div>
</div>
<p>Si haces click nuevamente en el botón &#8220;Registrarme&#8221;, verás esta vez una página en blanco.
Necesitamos ahora almacenar el nombre y correo electrónico que el usuario proporcionó en una base de datos.</p>
<p>De acuerdo con el patrón MVC, las interacciones con la base de datos deben realizarse a través de modelos (models) así también
nos aseguramos que la aplicación está completamente orientada a objetos.</p>
</div>
<div class="section" id="creando-un-modelo">
<h3>Creando un Modelo<a class="headerlink" href="#creando-un-modelo" title="Enlazar permanentemente con este título">¶</a></h3>
<p>Phalcon posee el primer ORM para PHP escrito totalmente en C. En vez de aumentar la complejidad del desarrollo, la simplifica.</p>
<p>Antes de crear nuestro primer modelo, necesitamos una tabla que el modelo use para mapearse. Una simple tabla para guardar los
usuarios registrados puede ser la siguiente:</p>
<div class="highlight-sql"><div class="highlight"><pre><span class="k">CREATE</span> <span class="k">TABLE</span> <span class="o">`</span><span class="n">users</span><span class="o">`</span> <span class="p">(</span>
  <span class="o">`</span><span class="n">id</span><span class="o">`</span> <span class="nb">int</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="n">unsigned</span> <span class="k">NOT</span> <span class="k">NULL</span> <span class="n">AUTO_INCREMENT</span><span class="p">,</span>
  <span class="o">`</span><span class="n">name</span><span class="o">`</span> <span class="nb">varchar</span><span class="p">(</span><span class="mi">70</span><span class="p">)</span> <span class="k">NOT</span> <span class="k">NULL</span><span class="p">,</span>
  <span class="o">`</span><span class="n">email</span><span class="o">`</span> <span class="nb">varchar</span><span class="p">(</span><span class="mi">70</span><span class="p">)</span> <span class="k">NOT</span> <span class="k">NULL</span><span class="p">,</span>
  <span class="k">PRIMARY</span> <span class="k">KEY</span> <span class="p">(</span><span class="o">`</span><span class="n">id</span><span class="o">`</span><span class="p">)</span>
<span class="p">);</span>
</pre></div>
</div>
<p>Según como hemos organizado esta aplicación, un modelo debe ser ubicado en el directorio app/models. El modelo que mapea a la tabla &#8220;users&#8221; es:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="cp">&lt;?php</span>

<span class="k">class</span> <span class="nc">Users</span> <span class="k">extends</span> <span class="nx">\Phalcon\Mvc\Model</span>
<span class="p">{</span>

<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="estableciendo-la-conexion-a-la-base-de-datos">
<h3>Estableciendo la conexión a la base de datos<a class="headerlink" href="#estableciendo-la-conexion-a-la-base-de-datos" title="Enlazar permanentemente con este título">¶</a></h3>
<p>Para poder conectarnos a una base de datos y por lo tanto usar nuestros modelos, necesitamos especificar esta configuración en el bootstrap
de la aplicación.</p>
<p>Una conexión a una base de datos es simplemente otro servicio que nuestra aplicación usará en muchos componentes, entre ellos PhalconMvcModel:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="cp">&lt;?php</span>

<span class="k">try</span> <span class="p">{</span>

    <span class="c1">//Registrar un autoloader</span>
    <span class="nv">$loader</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">\Phalcon\Loader</span><span class="p">();</span>
    <span class="nv">$loader</span><span class="o">-&gt;</span><span class="na">registerDirs</span><span class="p">(</span><span class="k">array</span><span class="p">(</span>
        <span class="s1">&#39;../app/controllers/&#39;</span><span class="p">,</span>
        <span class="s1">&#39;../app/models/&#39;</span>
    <span class="p">))</span><span class="o">-&gt;</span><span class="na">register</span><span class="p">();</span>

    <span class="c1">//Crear un DI</span>
    <span class="nv">$di</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Phalcon\DI\FactoryDefault</span><span class="p">();</span>

    <span class="c1">//Establecer el servicio de base de datos</span>
    <span class="nv">$di</span><span class="o">-&gt;</span><span class="na">set</span><span class="p">(</span><span class="s1">&#39;db&#39;</span><span class="p">,</span> <span class="k">function</span><span class="p">(){</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nx">\Phalcon\Db\Adapter\Pdo\Mysql</span><span class="p">(</span><span class="k">array</span><span class="p">(</span>
            <span class="s2">&quot;host&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;localhost&quot;</span><span class="p">,</span>
            <span class="s2">&quot;username&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;root&quot;</span><span class="p">,</span>
            <span class="s2">&quot;password&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;secret&quot;</span><span class="p">,</span>
            <span class="s2">&quot;dbname&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;test_db&quot;</span>
        <span class="p">));</span>
    <span class="p">});</span>

    <span class="c1">//Establecer el servicio de vistas</span>
    <span class="nv">$di</span><span class="o">-&gt;</span><span class="na">set</span><span class="p">(</span><span class="s1">&#39;view&#39;</span><span class="p">,</span> <span class="k">function</span><span class="p">(){</span>
        <span class="nv">$view</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">\Phalcon\Mvc\View</span><span class="p">();</span>
        <span class="nv">$view</span><span class="o">-&gt;</span><span class="na">setViewsDir</span><span class="p">(</span><span class="s1">&#39;../app/views/&#39;</span><span class="p">);</span>
        <span class="k">return</span> <span class="nv">$view</span><span class="p">;</span>
    <span class="p">});</span>

    <span class="c1">//Atender la petición</span>
    <span class="nv">$application</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">\Phalcon\Mvc\Application</span><span class="p">(</span><span class="nv">$di</span><span class="p">);</span>

    <span class="k">echo</span> <span class="nv">$application</span><span class="o">-&gt;</span><span class="na">handle</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">getContent</span><span class="p">();</span>

<span class="p">}</span> <span class="k">catch</span><span class="p">(</span><span class="nx">Exception</span> <span class="nv">$e</span><span class="p">)</span> <span class="p">{</span>
     <span class="k">echo</span> <span class="s2">&quot;Phalcon Exception: &quot;</span><span class="p">,</span> <span class="nv">$e</span><span class="o">-&gt;</span><span class="na">getMessage</span><span class="p">();</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Con una configuración correcta, nuestros modelos están listos para trabajar e interactuar con el resto de la aplicación.</p>
</div>
<div class="section" id="guardando-datos-mediante-modelos">
<h3>Guardando datos mediante modelos<a class="headerlink" href="#guardando-datos-mediante-modelos" title="Enlazar permanentemente con este título">¶</a></h3>
<p>Recibir datos desde el formulario y posteriormente guardarlos en una tabla es el siguiente paso:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="cp">&lt;?php</span>

<span class="k">class</span> <span class="nc">SignupController</span> <span class="k">extends</span> <span class="nx">\Phalcon\Mvc\Controller</span>
<span class="p">{</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">indexAction</span><span class="p">()</span>
    <span class="p">{</span>

    <span class="p">}</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">registerAction</span><span class="p">()</span>
    <span class="p">{</span>

        <span class="nv">$user</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Users</span><span class="p">();</span>

        <span class="c1">//Almacenar y verificar errores de validación</span>
        <span class="nv">$success</span> <span class="o">=</span> <span class="nv">$user</span><span class="o">-&gt;</span><span class="na">save</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">request</span><span class="o">-&gt;</span><span class="na">getPost</span><span class="p">(),</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="s1">&#39;email&#39;</span><span class="p">));</span>

        <span class="k">if</span> <span class="p">(</span><span class="nv">$success</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">echo</span> <span class="s2">&quot;Gracias por registrarte!&quot;</span><span class="p">;</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="k">echo</span> <span class="s2">&quot;Lo sentimos, los siguientes errores ocurrieron mientras te dabamos de alta: &quot;</span><span class="p">;</span>
            <span class="k">foreach</span> <span class="p">(</span><span class="nv">$user</span><span class="o">-&gt;</span><span class="na">getMessages</span><span class="p">()</span> <span class="k">as</span> <span class="nv">$message</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">echo</span> <span class="nv">$message</span><span class="o">-&gt;</span><span class="na">getMessage</span><span class="p">(),</span> <span class="s2">&quot;&lt;br/&gt;&quot;</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>

<span class="p">}</span>
</pre></div>
</div>
<p>Instanciamos la clase &#8220;Users&#8221;, que corresponde a un registro de la tabla &#8220;users&#8221;. Las propiedades públicas en la clase
representan los campos que tiene cada registro en la tabla. Establecemos los datos necesarios en el modelo
y llamamos al método &#8220;save()&#8221; para que almacene estos datos en la tabla. El método save() retorna un valor booleano (true/false)
que indica si el proceso de guardar fue correcto o no.</p>
<p>El ORM automaticamente escapa la entrada de datos previniendo inyecciones de SQL, de esta manera podemos simplemente pasar
los datos al método save().</p>
<p>Una validación adicional sobre los campos que no permiten valores nulos (obligatorios) es ejecutada de manera automática.
Si no entramos ningún valor en el formulario y tratamos de guardar veremos lo siguiente:</p>
<div class="figure align-center">
<img alt="../_images/tutorial-4.png" src="../_images/tutorial-4.png" />
</div>
</div>
</div>
<div class="section" id="conclusion">
<h2>Conclusión<a class="headerlink" href="#conclusion" title="Enlazar permanentemente con este título">¶</a></h2>
<p>Como podrás ver este es un tutorial muy sencillo que permite aprender a crear aplicaciones con Phalcon.
El hecho de que PHalcon es una extensión para PHP no ha interferido en la facilidad de desarrollo
o características disponibles. Te invitamos a que continues leyendo el manual y descubrar muchas más características
que ofrece Phalcon!</p>
</div>
<div class="section" id="aplicaciones-de-ejemplo">
<h2>Aplicaciones de Ejemplo<a class="headerlink" href="#aplicaciones-de-ejemplo" title="Enlazar permanentemente con este título">¶</a></h2>
<p>A continuación tienes ejemplos de aplicaciones de mayor complejidad:</p>
<ul class="simple">
<li><a class="reference external" href="http://blog.phalconphp.com/post/20928554661/invo-a-sample-application">INVO application</a>: Generación de facturas. Permite adiministrar clientes, productos, tipos de producto. etc.</li>
<li><a class="reference external" href="http://blog.phalconphp.com/post/24622423072/sample-application-php-alternative-site">PHP Alternative website</a>: Aplicación multi-idioma con enrutamiento avanzado</li>
<li><a class="reference external" href="http://blog.phalconphp.com/post/37515965262/sample-application-album-orama">Album O&#8217;Rama</a>: Un catalogo de albunes de música con un gran número de datos que usa <a class="reference internal" href="phql.html"><em>PHQL</em></a> y <a class="reference internal" href="volt.html"><em>Volt</em></a> como motor de plantillas</li>
<li><a class="reference external" href="http://blog.phalconphp.com/post/41461000213/phosphorum-the-phalcons-forum">Phosphorum</a>: Un foro simple y compacto</li>
</ul>
</div>
</div>


                    </div>
                  </div>
                </div>
            </div>
          </td>
        </tr>
      </table>
    <div class="related">
      <ul>
        <li class="right" >
          <a href="../genindex.html" title="Índice General"
             >índice</a></li>
        <li class="right" >
          <a href="tutorial-invo.html" title="Tutorial 2: Explicando INVO"
             >siguiente</a> |</li>
        <li class="right" >
          <a href="cherokee.html" title="Notas para la instalación en Cherokee"
             >anterior</a> |</li> 
      </ul>
    </div>
        <div id="footer">

          <p>Found a typo or an error? Want to improve this document? The documentation sources are available on <a href="http://github.com/phalcon/docs">Github</a></p>
          <p>Need support or have questions? Check our <a href="http://phalconphp.com/support">Support Page</a></p>

          <p>The Phalcon PHP Framework is released under the <a href="https://github.com/phalcon/cphalcon/blob/master/docs/LICENSE.md">new BSD license</a>.</p>
          <p>Except where otherwise noted, content on this site is licensed under the
            <a href="http://creativecommons.org/licenses/by/3.0/">Creative Commons Attribution 3.0 License.</a></p>
             Actualizado por última vez en Oct 21, 2014.
            Creado con <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.

          <p>
             &copy; Copyright 2014, Phalcon Team and contributors.
          </p>

            <div class="size-wrap footer-wrap">

                <div class="donate-wrap">
                    Donate to Phalcon: <a href="http://flattr.com/thing/1134206/Phalcon-PHP-Framework" target="_blank" class="button button-small orange">Flattr</a>
                    or
                    <form action="https://www.paypal.com/cgi-bin/webscr" method="post" style="display: inline">
                        <input type="hidden" name="cmd" value="_s-xclick">
                        <input type="hidden" name="hosted_button_id" value="7LSYMNMFZNG8W">
                        <input class="button button-small orange" style="border: inherit; display: inline; font-weight: bold" type="submit" value="via Paypal" title="PayPal — The safer, easier way to pay online.">
                    </form>
                </div>

                <div class="social-links">
                    <a href="https://twitter.com/phalconphp" class="social-link tw">Twitter</a>
                    <a href="http://www.facebook.com/pages/Phalcon/134230726685897" class="social-link fb">Facebook</a>
                    <a href="https://plus.google.com/102376109340560896457" class="social-link gp">Google Plus</a>
                    <a href="http://vimeo.com/user10964377" class="social-link vm">Vimeo</a>
                </div>

            </div>

        </div>

    </div>
    <script type="text/javascript">
    $(window).on("load", function(){
      var cx = '009733439235723428699:lh9ltjgvdz8';
      var gcse = document.createElement('script');
      gcse.type = 'text/javascript';
      gcse.async = true;
      gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//www.google.com/cse/cse.js?cx=' + cx;
      var s = document.getElementsByTagName('script')[0];
      s.parentNode.insertBefore(gcse, s);
      /*window.setTimeout(function(){
        $('.gsc-search-button').css({
          'background': '#f06715',
          'padding': '2px',
          'border': '0'
        });
      }, 1000)*/
    });
    </script>

  </body>
</html>